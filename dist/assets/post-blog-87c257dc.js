import{l as C,n as x,r as c,z as v,A as B,o as d,Q as u,j as e,W as T,y as E,G as F,B as j,S as h,C as P,L as k,D as w}from"./index-ef06bb94.js";import"./ckeditor-54d5a1f1.js";import{c as L,a as D}from"./object-b811dff8.js";import{T as f}from"./TextField-f4746776.js";import"./identity-69e6ff7f.js";import"./Select-28047b4e.js";import"./Menu-32b2f8ca.js";import"./isMuiElement-7cfb1190.js";const b=L().shape({title:D().required("Title is required")});function J(){var p;const a=C(),o=x(t=>t),s=x(t=>t.property),g=(p=o==null?void 0:o.auth.user)==null?void 0:p.token,[n,m]=c.useState(""),i=v({initialValues:{title:"",body:""},validationSchema:b,onSubmit:async(t,{setSubmitting:l})=>{try{const r=new FormData;r.append("title",t.title),r.append("body",t.body),n&&r.append("image",n),await a(B({formData:r,token:g})),i.resetForm(),m(""),a(d())}catch(r){i.resetForm(),setTimeout(()=>{a(d())},300),console.error("Error submitting form:",r)}finally{l(!1)}}}),y=t=>{const l=t.target.files[0];m(l)};return c.useEffect(()=>{a(d())},[a]),c.useEffect(()=>{s!=null&&s.isSuccess&&(s!=null&&s.postedBlog)&&u.success("Posted successfullly!"),s!=null&&s.isError&&u.error("Post failed!")},[s==null?void 0:s.isSuccess,s==null?void 0:s.postedBlog,s==null?void 0:s.isError]),e.jsxs(e.Fragment,{children:[e.jsx(T,{children:e.jsx("title",{children:"JEA | Post "})}),e.jsx(E,{maxWidth:"xl",children:e.jsxs(F,{container:!0,spacing:3,children:[e.jsx("h2",{style:{padding:"3rem 2rem"},children:"Post Agent"}),e.jsx(j,{sx:{height:1,width:"100%",padding:"30px"},children:e.jsx("form",{onSubmit:i.handleSubmit,children:e.jsx(h,{alignItems:"center",justifyContent:"center",sx:{height:1},children:e.jsx(P,{sx:{p:5,width:1,maxWidth:620},children:e.jsxs(h,{spacing:3,children:[e.jsx(f,{label:"Name",name:"title",value:i.values.title,onChange:i.handleChange,error:i.touched.title&&!!i.errors.title,helperText:i.touched.title&&i.errors.title}),e.jsx("div",{children:e.jsx(f,{label:"Job Description",name:"body",value:i.values.body,onChange:i.handleChange})}),e.jsx(h,{children:e.jsxs("div",{className:"upload-wrap",children:[e.jsxs("label",{htmlFor:"inputTag",className:"upload-label",children:[e.jsx("img",{src:"/assets/icons/shape-avatar.svg",alt:""}),e.jsx("span",{children:"Upload Images"}),e.jsx("input",{name:"image",id:"inputTag",type:"file",className:"upload-input",onChange:y})]}),e.jsxs("span",{children:["Max file size 2MB. ",e.jsx("br",{})," CTRL+ click to select multiple images"]})]})}),e.jsx("div",{style:{width:"400px",height:"auto"},children:n&&e.jsx("img",{src:URL.createObjectURL(n),alt:"Selected"})}),e.jsx(k,{sx:{marginTop:"25px"},fullWidth:!0,size:"large",type:"submit",variant:"contained",color:"inherit",children:s!=null&&s.isLoading?e.jsx(j,{sx:{display:"flex"},children:e.jsx(w,{})}):"Post"})]})})})})})]})})]})}export{J as default};
